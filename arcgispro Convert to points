import arcpy
import os

# 1. 设置工作空间和路径
csv_path = r"G:\bamboo\csv_point\Samples_NoBambusa.csv"
output_folder = r"G:\bamboo"
output_name = "Samples_NoBambusa_Points.shp"  # 也可以直接存入数据库，如 "MyGDB.gdb\points"
output_path = os.path.join(output_folder, output_name)

# 2. 定义坐标系（通常 CSV 的经纬度是 WGS 84，代码为 4326）
sp_ref = arcpy.SpatialReference(4326)

# 3. 执行转换
print("正在转换 CSV 为点要素...")
try:
    # 这一步会先在内存中创建一个临时图层
    temp_layer = "temp_csv_layer"
    arcpy.management.MakeXYEventLayer(
        table=csv_path,
        in_x_field="longitude",
        in_y_field="latitude",
        out_layer=temp_layer,
        spatial_reference=sp_ref
    )

    # 4. 将临时图层永久保存到本地
    arcpy.management.CopyFeatures(temp_layer, output_path)
    
    print(f"转换成功！文件已保存至: {output_path}")

except Exception as e:
    print(f"转换失败: {e}")
